<UserControl x:Class="ExcelAutomation.Views.BatchProcessingView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:sys="clr-namespace:System;assembly=mscorlib">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Text="バッチ一括処理" Style="{StaticResource MaterialDesignHeadline4TextBlock}" Margin="0,0,0,20" />

        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
            <Button Style="{StaticResource MaterialDesignOutlinedButton}" Content="フォルダを追加" Margin="0,0,10,0"
                    Click="SelectFolderButton_Click">
                <Button.ContentTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="FolderPlus" Margin="0,0,5,0"/>
                            <TextBlock Text="フォルダ追加"/>
                        </StackPanel>
                    </DataTemplate>
                </Button.ContentTemplate>
            </Button>
            <Button Style="{StaticResource MaterialDesignFlatButton}" 
                    Content="リストクリア" 
                    Foreground="Gray"
                    Command="{Binding ClearCommand}" />
        </StackPanel>

        <DataGrid x:Name="MainDataGrid"
                    ItemsSource="{Binding FileList}"
                    Grid.Row="2" AutoGenerateColumns="False" CanUserAddRows="False"
                    HeadersVisibility="All" SelectionUnit="FullRow"
                    materialDesign:DataGridAssist.CellPadding="13 8 8 8"
                    materialDesign:DataGridAssist.ColumnHeaderPadding="8">
            <DataGrid.Columns>
                <DataGridCheckBoxColumn Header="対象" Binding="{Binding IsSelected}" ElementStyle="{StaticResource MaterialDesignDataGridCheckBoxColumnStyle}" EditingElementStyle="{StaticResource MaterialDesignDataGridCheckBoxColumnEditingStyle}"/>
                <DataGridTextColumn Header="ファイル名" Binding="{Binding FileName}" Width="200" IsReadOnly="True"/>
                <DataGridTextColumn Header="パス" Binding="{Binding FilePath}" Width="*" IsReadOnly="True"/>
            </DataGrid.Columns>

        </DataGrid>

        <materialDesign:ColorZone Grid.Row="3" Mode="Standard" Padding="16" Margin="0,10,0,0" CornerRadius="5" materialDesign:ElevationAssist.Elevation="Dp2">
            <DockPanel>
                <Button Content="一括処理開始" Style="{StaticResource MaterialDesignRaisedButton}" DockPanel.Dock="Right" Width="150" Command="{Binding ExecuteCommand}" />

                <ComboBox x:Name="LogicSelector"
                          SelectedValuePath="Tag"
                          SelectedValue="{Binding SelectedLogicTag}"
                          materialDesign:HintAssist.Hint="処理を選択してください"
                          Width="220"
                          Margin="0,0,20,0"
                          VerticalAlignment="Center"
                          DockPanel.Dock="Right"
                          SelectedIndex="0">

                    <ComboBoxItem Content="売上登録 (Daily)" Tag="Sales"  />
                    <ComboBoxItem Content="請求書PDF発行 (PDF Export)" Tag="Invoice" />
                    
                </ComboBox>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="合計ファイル数: " FontWeight="Bold"/>
                    <TextBlock Text="{Binding FileList.Count, StringFormat={}{0} 件}"/>
                </StackPanel>
            </DockPanel>
        </materialDesign:ColorZone>

        <materialDesign:Snackbar MessageQueue="{Binding MessageQueue}"
                                 Grid.RowSpan="4"
                                 VerticalAlignment="Bottom" />
    </Grid>
</UserControl>